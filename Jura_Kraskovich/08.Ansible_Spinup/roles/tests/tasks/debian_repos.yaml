---
- name: Check Debian repos
  block:
    - name: Check Debian repos
      uri:
        url: "{{ item }}"
        return_content: yes
      register: out_debian
      with_items: "{{ debian_repos }}"
      failed_when: out_debian.status != 200
  rescue:
    - name: Slak notification
      slack:
        token: TFBPBNB2L/BUP6ZS22G/ghM0qjhvugFdTupaUa1UkUdL
        msg: 'Debian repos not available on {{ ansible_hostname }}'
        channel: '#ansible_ntf'
        color: danger
        username: '{{ inventory_hostname }}'